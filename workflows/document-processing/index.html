<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="DocuSnap-Backend System Architecture Analysis Documentation"><meta name=author content=JI-DeepSleep><link href=../overview/ rel=prev><link href=../form-processing/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.16"><title>Document Processing Workflow - DocuSnap-Backend Architecture Analysis</title><link rel=stylesheet href=../../assets/stylesheets/main.7e37652d.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config",""),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#document-processing-workflow class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="DocuSnap-Backend Architecture Analysis" class="md-header__button md-logo" aria-label="DocuSnap-Backend Architecture Analysis" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m19 2-5 4.5v11l5-4.5zM6.5 5C4.55 5 2.45 5.4 1 6.5v14.66c0 .25.25.5.5.5.1 0 .15-.07.25-.07 1.35-.65 3.3-1.09 4.75-1.09 1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.31 4.75 1.06.1.05.15.03.25.03.25 0 .5-.25.5-.5V6.5c-.6-.45-1.25-.75-2-1V19c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V6.5C10.55 5.4 8.45 5 6.5 5"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> DocuSnap-Backend Architecture Analysis </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Document Processing Workflow </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/JI-DeepSleep/DocuSnap-Backend title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> JI-DeepSleep/DocuSnap-Backend </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../overview/background/ class=md-tabs__link> Project Overview </a> </li> <li class=md-tabs__item> <a href=../../tech-stack/technology-selection/ class=md-tabs__link> Technology Stack </a> </li> <li class=md-tabs__item> <a href=../../architecture/overview/ class=md-tabs__link> Architecture Design </a> </li> <li class=md-tabs__item> <a href=../../core-modules/overview/ class=md-tabs__link> Core Modules </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../overview/ class=md-tabs__link> Typical Workflows </a> </li> <li class=md-tabs__item> <a href=../../code-quality/assessment/ class=md-tabs__link> Code Quality </a> </li> <li class=md-tabs__item> <a href=../../deployment/overview/ class=md-tabs__link> Deployment Architecture </a> </li> <li class=md-tabs__item> <a href=../../conclusions/quick-start/ class=md-tabs__link> Conclusions & Recommendations </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="DocuSnap-Backend Architecture Analysis" class="md-nav__button md-logo" aria-label="DocuSnap-Backend Architecture Analysis" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m19 2-5 4.5v11l5-4.5zM6.5 5C4.55 5 2.45 5.4 1 6.5v14.66c0 .25.25.5.5.5.1 0 .15-.07.25-.07 1.35-.65 3.3-1.09 4.75-1.09 1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.31 4.75 1.06.1.05.15.03.25.03.25 0 .5-.25.5-.5V6.5c-.6-.45-1.25-.75-2-1V19c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V6.5C10.55 5.4 8.45 5 6.5 5"/></svg> </a> DocuSnap-Backend Architecture Analysis </label> <div class=md-nav__source> <a href=https://github.com/JI-DeepSleep/DocuSnap-Backend title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> JI-DeepSleep/DocuSnap-Backend </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Project Overview </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Project Overview </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../overview/background/ class=md-nav__link> <span class=md-ellipsis> Background </span> </a> </li> <li class=md-nav__item> <a href=../../overview/target-users/ class=md-nav__link> <span class=md-ellipsis> Target Users </span> </a> </li> <li class=md-nav__item> <a href=../../overview/core-features/ class=md-nav__link> <span class=md-ellipsis> Core Features </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Technology Stack </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Technology Stack </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../tech-stack/technology-selection/ class=md-nav__link> <span class=md-ellipsis> Technology Selection </span> </a> </li> <li class=md-nav__item> <a href=../../tech-stack/selection-rationale/ class=md-nav__link> <span class=md-ellipsis> Selection Rationale </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Architecture Design </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Architecture Design </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../architecture/overview/ class=md-nav__link> <span class=md-ellipsis> Architecture Overview </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/diagrams/ class=md-nav__link> <span class=md-ellipsis> Architecture Diagrams </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/layers/ class=md-nav__link> <span class=md-ellipsis> Layer Description </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Core Modules </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Core Modules </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../core-modules/overview/ class=md-nav__link> <span class=md-ellipsis> Module Overview </span> </a> </li> <li class=md-nav__item> <a href=../../core-modules/task-processing/ class=md-nav__link> <span class=md-ellipsis> Task Processing Module </span> </a> </li> <li class=md-nav__item> <a href=../../core-modules/ocr-processing/ class=md-nav__link> <span class=md-ellipsis> OCR Processing Module </span> </a> </li> <li class=md-nav__item> <a href=../../core-modules/llm-processing/ class=md-nav__link> <span class=md-ellipsis> LLM Processing Module </span> </a> </li> <li class=md-nav__item> <a href=../../core-modules/security-encryption/ class=md-nav__link> <span class=md-ellipsis> Security & Encryption Module </span> </a> </li> <li class=md-nav__item> <a href=../../core-modules/cache-persistence/ class=md-nav__link> <span class=md-ellipsis> Cache & Persistence Module </span> </a> </li> <li class=md-nav__item> <a href=../../core-modules/relationships/ class=md-nav__link> <span class=md-ellipsis> Module Relationships </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6 checked> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex> <span class=md-ellipsis> Typical Workflows </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=true> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Typical Workflows </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../overview/ class=md-nav__link> <span class=md-ellipsis> Workflow Overview </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Document Processing Workflow </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Document Processing Workflow </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#workflow-overview class=md-nav__link> <span class=md-ellipsis> Workflow Overview </span> </a> </li> <li class=md-nav__item> <a href=#detailed-process class=md-nav__link> <span class=md-ellipsis> Detailed Process </span> </a> <nav class=md-nav aria-label="Detailed Process"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-request-reception-and-validation class=md-nav__link> <span class=md-ellipsis> 1. Request Reception and Validation </span> </a> </li> <li class=md-nav__item> <a href=#2-cache-check-and-task-creation class=md-nav__link> <span class=md-ellipsis> 2. Cache Check and Task Creation </span> </a> </li> <li class=md-nav__item> <a href=#3-ocr-processing class=md-nav__link> <span class=md-ellipsis> 3. OCR Processing </span> </a> </li> <li class=md-nav__item> <a href=#4-llm-processing class=md-nav__link> <span class=md-ellipsis> 4. LLM Processing </span> </a> </li> <li class=md-nav__item> <a href=#5-result-processing class=md-nav__link> <span class=md-ellipsis> 5. Result Processing </span> </a> </li> <li class=md-nav__item> <a href=#6-status-query-and-result-return class=md-nav__link> <span class=md-ellipsis> 6. Status Query and Result Return </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#document-processing-prompt class=md-nav__link> <span class=md-ellipsis> Document Processing Prompt </span> </a> </li> <li class=md-nav__item> <a href=#processing-result-example class=md-nav__link> <span class=md-ellipsis> Processing Result Example </span> </a> </li> <li class=md-nav__item> <a href=#error-handling class=md-nav__link> <span class=md-ellipsis> Error Handling </span> </a> </li> <li class=md-nav__item> <a href=#performance-optimization class=md-nav__link> <span class=md-ellipsis> Performance Optimization </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../form-processing/ class=md-nav__link> <span class=md-ellipsis> Form Processing Workflow </span> </a> </li> <li class=md-nav__item> <a href=../form-filling/ class=md-nav__link> <span class=md-ellipsis> Form Auto-filling Workflow </span> </a> </li> <li class=md-nav__item> <a href=../data-flow/ class=md-nav__link> <span class=md-ellipsis> Data Flow Diagrams </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> Code Quality </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Code Quality </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../code-quality/assessment/ class=md-nav__link> <span class=md-ellipsis> Quality Assessment </span> </a> </li> <li class=md-nav__item> <a href=../../code-quality/design-patterns/ class=md-nav__link> <span class=md-ellipsis> Design Patterns </span> </a> </li> <li class=md-nav__item> <a href=../../code-quality/improvement-suggestions/ class=md-nav__link> <span class=md-ellipsis> Improvement Suggestions </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex=0> <span class=md-ellipsis> Deployment Architecture </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=false> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Deployment Architecture </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../deployment/overview/ class=md-nav__link> <span class=md-ellipsis> Deployment Overview </span> </a> </li> <li class=md-nav__item> <a href=../../deployment/diagrams/ class=md-nav__link> <span class=md-ellipsis> Deployment Diagrams </span> </a> </li> <li class=md-nav__item> <a href=../../deployment/tech-stack/ class=md-nav__link> <span class=md-ellipsis> Technology Stack </span> </a> </li> <li class=md-nav__item> <a href=../../deployment/scalability-fault-tolerance/ class=md-nav__link> <span class=md-ellipsis> Scalability & Fault Tolerance </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_9> <label class=md-nav__link for=__nav_9 id=__nav_9_label tabindex=0> <span class=md-ellipsis> Conclusions & Recommendations </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_9_label aria-expanded=false> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> Conclusions & Recommendations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../conclusions/quick-start/ class=md-nav__link> <span class=md-ellipsis> Quick Start Guide </span> </a> </li> <li class=md-nav__item> <a href=../../conclusions/optimization/ class=md-nav__link> <span class=md-ellipsis> Optimization Directions </span> </a> </li> <li class=md-nav__item> <a href=../../conclusions/summary/ class=md-nav__link> <span class=md-ellipsis> Summary Assessment </span> </a> </li> <li class=md-nav__item> <a href=../../conclusions/references/ class=md-nav__link> <span class=md-ellipsis> References </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#workflow-overview class=md-nav__link> <span class=md-ellipsis> Workflow Overview </span> </a> </li> <li class=md-nav__item> <a href=#detailed-process class=md-nav__link> <span class=md-ellipsis> Detailed Process </span> </a> <nav class=md-nav aria-label="Detailed Process"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-request-reception-and-validation class=md-nav__link> <span class=md-ellipsis> 1. Request Reception and Validation </span> </a> </li> <li class=md-nav__item> <a href=#2-cache-check-and-task-creation class=md-nav__link> <span class=md-ellipsis> 2. Cache Check and Task Creation </span> </a> </li> <li class=md-nav__item> <a href=#3-ocr-processing class=md-nav__link> <span class=md-ellipsis> 3. OCR Processing </span> </a> </li> <li class=md-nav__item> <a href=#4-llm-processing class=md-nav__link> <span class=md-ellipsis> 4. LLM Processing </span> </a> </li> <li class=md-nav__item> <a href=#5-result-processing class=md-nav__link> <span class=md-ellipsis> 5. Result Processing </span> </a> </li> <li class=md-nav__item> <a href=#6-status-query-and-result-return class=md-nav__link> <span class=md-ellipsis> 6. Status Query and Result Return </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#document-processing-prompt class=md-nav__link> <span class=md-ellipsis> Document Processing Prompt </span> </a> </li> <li class=md-nav__item> <a href=#processing-result-example class=md-nav__link> <span class=md-ellipsis> Processing Result Example </span> </a> </li> <li class=md-nav__item> <a href=#error-handling class=md-nav__link> <span class=md-ellipsis> Error Handling </span> </a> </li> <li class=md-nav__item> <a href=#performance-optimization class=md-nav__link> <span class=md-ellipsis> Performance Optimization </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=document-processing-workflow>Document Processing Workflow<a class=headerlink href=#document-processing-workflow title="Permanent link">&para;</a></h1> <p>Document processing is one of the core functions of the DocuSnap-Backend system, used to convert document images into structured text and extract key information. This page details the complete document processing workflow.</p> <h2 id=workflow-overview>Workflow Overview<a class=headerlink href=#workflow-overview title="Permanent link">&para;</a></h2> <p>The document processing workflow converts document images into structured text data, including document title, type, content summary, key information, etc. The entire process includes image processing, OCR recognition, LLM analysis, and result generation.</p> <pre class=mermaid><code>graph TD
    A["Receive Document Image"] --&gt; B["Request Validation &amp; Decryption"]
    B --&gt; C["Check Cache"]
    C --&gt;|"Cache Hit"| D["Return Cached Result"]
    C --&gt;|"Cache Miss"| E["Create Task"]
    E --&gt; F["OCR Processing"]
    F --&gt; G["LLM Document Analysis"]
    G --&gt; H["Result Storage"]
    H --&gt; I["Return Processing Result"]</code></pre> <h2 id=detailed-process>Detailed Process<a class=headerlink href=#detailed-process title="Permanent link">&para;</a></h2> <h3 id=1-request-reception-and-validation>1. Request Reception and Validation<a class=headerlink href=#1-request-reception-and-validation title="Permanent link">&para;</a></h3> <p>The document processing workflow begins with receiving a client request:</p> <ol> <li><strong>Receive Request</strong>:</li> <li>Client sends request through the <code>/api/process_document</code> endpoint</li> <li>Request contains encrypted document images (Base64 format)</li> <li> <p>Request uses RSA and AES hybrid encryption</p> </li> <li> <p><strong>Request Decryption</strong>:</p> </li> <li>Use RSA private key to decrypt AES key</li> <li>Use AES key to decrypt request data</li> <li> <p>Verify request signature to ensure data integrity</p> </li> <li> <p><strong>Parameter Validation</strong>:</p> </li> <li>Validate if request parameters are complete</li> <li>Validate if image format is correct</li> <li>Validate if image count is within allowed range</li> </ol> <p><strong>Code Example</strong>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nd>@app</span><span class=o>.</span><span class=n>route</span><span class=p>(</span><span class=s1>&#39;/api/process_document&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;POST&#39;</span><span class=p>])</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=k>def</span><span class=w> </span><span class=nf>process_document</span><span class=p>():</span>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>    <span class=k>try</span><span class=p>:</span>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>        <span class=c1># Decrypt request</span>
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>request</span><span class=o>.</span><span class=n>is_json</span><span class=p>:</span>
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>            <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s2>&quot;error&quot;</span><span class=p>:</span> <span class=s2>&quot;Request must be in JSON format&quot;</span><span class=p>}),</span> <span class=mi>400</span>
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a>
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a>        <span class=n>data</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>get_json</span><span class=p>()</span>
<a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>
<a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a>        <span class=c1># Validate required parameters</span>
<a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a>        <span class=n>required_fields</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;encrypted_data&#39;</span><span class=p>,</span> <span class=s1>&#39;encrypted_key&#39;</span><span class=p>,</span> <span class=s1>&#39;signature&#39;</span><span class=p>]</span>
<a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a>        <span class=k>for</span> <span class=n>field</span> <span class=ow>in</span> <span class=n>required_fields</span><span class=p>:</span>
<a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a>            <span class=k>if</span> <span class=n>field</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>data</span><span class=p>:</span>
<a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a>                <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s2>&quot;error&quot;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&quot;Missing required parameter: </span><span class=si>{</span><span class=n>field</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>}),</span> <span class=mi>400</span>
<a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a>
<a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a>        <span class=c1># Decrypt request data</span>
<a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a>        <span class=k>try</span><span class=p>:</span>
<a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a>            <span class=n>decrypted_data</span><span class=p>,</span> <span class=n>aes_key</span> <span class=o>=</span> <span class=n>decrypt_request</span><span class=p>(</span>
<a id=__codelineno-0-19 name=__codelineno-0-19 href=#__codelineno-0-19></a>                <span class=n>data</span><span class=p>[</span><span class=s1>&#39;encrypted_data&#39;</span><span class=p>],</span>
<a id=__codelineno-0-20 name=__codelineno-0-20 href=#__codelineno-0-20></a>                <span class=n>data</span><span class=p>[</span><span class=s1>&#39;encrypted_key&#39;</span><span class=p>],</span>
<a id=__codelineno-0-21 name=__codelineno-0-21 href=#__codelineno-0-21></a>                <span class=n>data</span><span class=p>[</span><span class=s1>&#39;signature&#39;</span><span class=p>]</span>
<a id=__codelineno-0-22 name=__codelineno-0-22 href=#__codelineno-0-22></a>            <span class=p>)</span>
<a id=__codelineno-0-23 name=__codelineno-0-23 href=#__codelineno-0-23></a>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
<a id=__codelineno-0-24 name=__codelineno-0-24 href=#__codelineno-0-24></a>            <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s2>&quot;error&quot;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&quot;Request decryption failed: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>}),</span> <span class=mi>400</span>
<a id=__codelineno-0-25 name=__codelineno-0-25 href=#__codelineno-0-25></a>
<a id=__codelineno-0-26 name=__codelineno-0-26 href=#__codelineno-0-26></a>        <span class=c1># Validate decrypted data</span>
<a id=__codelineno-0-27 name=__codelineno-0-27 href=#__codelineno-0-27></a>        <span class=k>if</span> <span class=s1>&#39;images&#39;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>decrypted_data</span> <span class=ow>or</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>decrypted_data</span><span class=p>[</span><span class=s1>&#39;images&#39;</span><span class=p>],</span> <span class=nb>list</span><span class=p>):</span>
<a id=__codelineno-0-28 name=__codelineno-0-28 href=#__codelineno-0-28></a>            <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s2>&quot;error&quot;</span><span class=p>:</span> <span class=s2>&quot;Missing images parameter or incorrect format&quot;</span><span class=p>}),</span> <span class=mi>400</span>
<a id=__codelineno-0-29 name=__codelineno-0-29 href=#__codelineno-0-29></a>
<a id=__codelineno-0-30 name=__codelineno-0-30 href=#__codelineno-0-30></a>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>decrypted_data</span><span class=p>[</span><span class=s1>&#39;images&#39;</span><span class=p>])</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
<a id=__codelineno-0-31 name=__codelineno-0-31 href=#__codelineno-0-31></a>            <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s2>&quot;error&quot;</span><span class=p>:</span> <span class=s2>&quot;At least one image must be provided&quot;</span><span class=p>}),</span> <span class=mi>400</span>
<a id=__codelineno-0-32 name=__codelineno-0-32 href=#__codelineno-0-32></a>
<a id=__codelineno-0-33 name=__codelineno-0-33 href=#__codelineno-0-33></a>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>decrypted_data</span><span class=p>[</span><span class=s1>&#39;images&#39;</span><span class=p>])</span> <span class=o>&gt;</span> <span class=n>MAX_IMAGES</span><span class=p>:</span>
<a id=__codelineno-0-34 name=__codelineno-0-34 href=#__codelineno-0-34></a>            <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s2>&quot;error&quot;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&quot;Image count exceeds limit (maximum </span><span class=si>{</span><span class=n>MAX_IMAGES</span><span class=si>}</span><span class=s2>)&quot;</span><span class=p>}),</span> <span class=mi>400</span>
<a id=__codelineno-0-35 name=__codelineno-0-35 href=#__codelineno-0-35></a>
<a id=__codelineno-0-36 name=__codelineno-0-36 href=#__codelineno-0-36></a>        <span class=c1># Process request...</span>
</code></pre></div> <h3 id=2-cache-check-and-task-creation>2. Cache Check and Task Creation<a class=headerlink href=#2-cache-check-and-task-creation title="Permanent link">&para;</a></h3> <p>Before processing the request, the system checks if there are cached results to avoid duplicate computation:</p> <ol> <li><strong>Cache Check</strong>:</li> <li>Generate cache key based on request parameters</li> <li>Query database for matching cached results</li> <li> <p>If cache hit, directly return cached result</p> </li> <li> <p><strong>Task Creation</strong>:</p> </li> <li>If cache miss, generate a unique task ID</li> <li>Create task record, set status to "pending"</li> <li> <p>Add task to processing queue</p> </li> <li> <p><strong>Return Task ID</strong>:</p> </li> <li>Return task ID to client</li> <li>Client can use task ID to query processing status and results</li> </ol> <p><strong>Code Example</strong>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=c1># Check cache</span>
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=n>cache_key</span> <span class=o>=</span> <span class=n>sha256_hash</span><span class=p>(</span><span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>decrypted_data</span><span class=p>,</span> <span class=n>sort_keys</span><span class=o>=</span><span class=kc>True</span><span class=p>))</span>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=n>cached_result</span> <span class=o>=</span> <span class=n>check_cache</span><span class=p>(</span><span class=n>cache_key</span><span class=p>)</span>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=k>if</span> <span class=n>cached_result</span><span class=p>:</span>
<a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>    <span class=c1># Return cached result</span>
<a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a>    <span class=n>response</span> <span class=o>=</span> <span class=n>encrypt_response</span><span class=p>(</span><span class=n>cached_result</span><span class=p>,</span> <span class=n>aes_key</span><span class=p>)</span>
<a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>(</span><span class=n>response</span><span class=p>),</span> <span class=mi>200</span>
<a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a>
<a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a><span class=c1># Create task</span>
<a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a><span class=n>task_id</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>uuid</span><span class=o>.</span><span class=n>uuid4</span><span class=p>())</span>
<a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a><span class=n>create_task_record</span><span class=p>(</span><span class=n>task_id</span><span class=p>,</span> <span class=s1>&#39;document&#39;</span><span class=p>)</span>
<a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a>
<a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a><span class=c1># Build task object</span>
<a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a><span class=n>task</span> <span class=o>=</span> <span class=p>{</span>
<a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a>    <span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=n>task_id</span><span class=p>,</span>
<a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a>    <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;document&#39;</span><span class=p>,</span>
<a id=__codelineno-1-18 name=__codelineno-1-18 href=#__codelineno-1-18></a>    <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=n>decrypted_data</span><span class=p>,</span>
<a id=__codelineno-1-19 name=__codelineno-1-19 href=#__codelineno-1-19></a>    <span class=s1>&#39;cache_key&#39;</span><span class=p>:</span> <span class=n>cache_key</span><span class=p>,</span>
<a id=__codelineno-1-20 name=__codelineno-1-20 href=#__codelineno-1-20></a>    <span class=s1>&#39;aes_key&#39;</span><span class=p>:</span> <span class=n>aes_key</span>
<a id=__codelineno-1-21 name=__codelineno-1-21 href=#__codelineno-1-21></a><span class=p>}</span>
<a id=__codelineno-1-22 name=__codelineno-1-22 href=#__codelineno-1-22></a>
<a id=__codelineno-1-23 name=__codelineno-1-23 href=#__codelineno-1-23></a><span class=c1># Add task to queue</span>
<a id=__codelineno-1-24 name=__codelineno-1-24 href=#__codelineno-1-24></a><span class=n>add_task_to_queue</span><span class=p>(</span><span class=n>task</span><span class=p>)</span>
<a id=__codelineno-1-25 name=__codelineno-1-25 href=#__codelineno-1-25></a>
<a id=__codelineno-1-26 name=__codelineno-1-26 href=#__codelineno-1-26></a><span class=c1># Return task ID</span>
<a id=__codelineno-1-27 name=__codelineno-1-27 href=#__codelineno-1-27></a><span class=n>response</span> <span class=o>=</span> <span class=n>encrypt_response</span><span class=p>({</span><span class=s1>&#39;task_id&#39;</span><span class=p>:</span> <span class=n>task_id</span><span class=p>},</span> <span class=n>aes_key</span><span class=p>)</span>
<a id=__codelineno-1-28 name=__codelineno-1-28 href=#__codelineno-1-28></a><span class=k>return</span> <span class=n>jsonify</span><span class=p>(</span><span class=n>response</span><span class=p>),</span> <span class=mi>202</span>  <span class=c1># 202 Accepted</span>
</code></pre></div> <h3 id=3-ocr-processing>3. OCR Processing<a class=headerlink href=#3-ocr-processing title="Permanent link">&para;</a></h3> <p>After a task enters the queue, worker threads perform OCR processing:</p> <ol> <li><strong>Image Preprocessing</strong>:</li> <li>Decode Base64 images</li> <li> <p>Perform necessary image optimization (such as resizing, contrast enhancement, etc.)</p> </li> <li> <p><strong>OCR Service Call</strong>:</p> </li> <li>Call CnOCR service for text recognition</li> <li>Process multiple images in parallel to improve efficiency</li> <li> <p>Use semaphores to control concurrency</p> </li> <li> <p><strong>OCR Result Processing</strong>:</p> </li> <li>Collect OCR results for all images</li> <li>Merge into complete text content</li> <li>Prepare input for LLM analysis</li> </ol> <p><strong>Code Example</strong>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=k>def</span><span class=w> </span><span class=nf>process_images</span><span class=p>(</span><span class=n>images</span><span class=p>):</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Process multiple images in parallel&quot;&quot;&quot;</span>
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>    <span class=c1># Create semaphore to control concurrent access to OCR service</span>
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>    <span class=n>ocr_semaphore</span> <span class=o>=</span> <span class=n>threading</span><span class=o>.</span><span class=n>Semaphore</span><span class=p>(</span><span class=n>OCR_MAX_CONCURRENT</span><span class=p>)</span>
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>    <span class=c1># Create thread pool</span>
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a>    <span class=k>with</span> <span class=n>ThreadPoolExecutor</span><span class=p>(</span><span class=n>max_workers</span><span class=o>=</span><span class=n>OCR_MAX_CONCURRENT</span><span class=p>)</span> <span class=k>as</span> <span class=n>executor</span><span class=p>:</span>
<a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a>        <span class=c1># Submit all image processing tasks</span>
<a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a>        <span class=n>future_to_image</span> <span class=o>=</span> <span class=p>{</span>
<a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a>            <span class=n>executor</span><span class=o>.</span><span class=n>submit</span><span class=p>(</span><span class=n>process_single_image</span><span class=p>,</span> <span class=n>image</span><span class=p>,</span> <span class=n>ocr_semaphore</span><span class=p>):</span> <span class=n>i</span> 
<a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a>            <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>image</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>images</span><span class=p>)</span>
<a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a>        <span class=p>}</span>
<a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a>
<a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a>        <span class=c1># Collect results</span>
<a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a>        <span class=n>results</span> <span class=o>=</span> <span class=p>[]</span>
<a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a>        <span class=k>for</span> <span class=n>future</span> <span class=ow>in</span> <span class=n>as_completed</span><span class=p>(</span><span class=n>future_to_image</span><span class=p>):</span>
<a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a>            <span class=k>try</span><span class=p>:</span>
<a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a>                <span class=n>result</span> <span class=o>=</span> <span class=n>future</span><span class=o>.</span><span class=n>result</span><span class=p>()</span>
<a id=__codelineno-2-19 name=__codelineno-2-19 href=#__codelineno-2-19></a>                <span class=n>results</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
<a id=__codelineno-2-20 name=__codelineno-2-20 href=#__codelineno-2-20></a>            <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
<a id=__codelineno-2-21 name=__codelineno-2-21 href=#__codelineno-2-21></a>                <span class=n>logging</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Image processing failed: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-2-22 name=__codelineno-2-22 href=#__codelineno-2-22></a>
<a id=__codelineno-2-23 name=__codelineno-2-23 href=#__codelineno-2-23></a>        <span class=c1># Sort results by original order</span>
<a id=__codelineno-2-24 name=__codelineno-2-24 href=#__codelineno-2-24></a>        <span class=n>results</span><span class=o>.</span><span class=n>sort</span><span class=p>(</span><span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=s1>&#39;index&#39;</span><span class=p>])</span>
<a id=__codelineno-2-25 name=__codelineno-2-25 href=#__codelineno-2-25></a>        <span class=k>return</span> <span class=p>[</span><span class=n>r</span><span class=p>[</span><span class=s1>&#39;text&#39;</span><span class=p>]</span> <span class=k>for</span> <span class=n>r</span> <span class=ow>in</span> <span class=n>results</span><span class=p>]</span>
</code></pre></div> <h3 id=4-llm-processing>4. LLM Processing<a class=headerlink href=#4-llm-processing title="Permanent link">&para;</a></h3> <p>After OCR processing is complete, the system uses LLM to analyze the text content:</p> <ol> <li><strong>Prompt Construction</strong>:</li> <li>Use document processing prompt template</li> <li>Insert OCR text into prompt template</li> <li> <p>Guide LLM to analyze document structure and content</p> </li> <li> <p><strong>LLM API Call</strong>:</p> </li> <li>Call Zhipu AI's LLM API</li> <li>Send constructed prompt</li> <li> <p>Receive LLM response</p> </li> <li> <p><strong>Response Parsing</strong>:</p> </li> <li>Parse text returned by LLM</li> <li>Extract structured data in JSON format</li> <li>Handle potential format issues</li> </ol> <p><strong>Code Example</strong>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=k>def</span><span class=w> </span><span class=nf>process_document_task</span><span class=p>(</span><span class=n>task</span><span class=p>):</span>
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Process document type tasks&quot;&quot;&quot;</span>
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>    <span class=n>update_task_status</span><span class=p>(</span><span class=n>task</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>],</span> <span class=s1>&#39;processing&#39;</span><span class=p>)</span>
<a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a>
<a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a>    <span class=k>try</span><span class=p>:</span>
<a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a>        <span class=c1># Process images</span>
<a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a>        <span class=n>ocr_results</span> <span class=o>=</span> <span class=n>process_images</span><span class=p>(</span><span class=n>task</span><span class=p>[</span><span class=s1>&#39;data&#39;</span><span class=p>][</span><span class=s1>&#39;images&#39;</span><span class=p>])</span>
<a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a>
<a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a>        <span class=c1># Build prompt and call LLM</span>
<a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a>        <span class=n>prompt</span> <span class=o>=</span> <span class=n>build_document_prompt</span><span class=p>(</span><span class=n>ocr_results</span><span class=p>)</span>
<a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a>        <span class=n>llm_result</span> <span class=o>=</span> <span class=n>call_llm_api</span><span class=p>(</span><span class=n>prompt</span><span class=p>)</span>
<a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a>
<a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a>        <span class=c1># Parse results</span>
<a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a>        <span class=n>parsed_result</span> <span class=o>=</span> <span class=n>parse_document_result</span><span class=p>(</span><span class=n>llm_result</span><span class=p>)</span>
<a id=__codelineno-3-15 name=__codelineno-3-15 href=#__codelineno-3-15></a>
<a id=__codelineno-3-16 name=__codelineno-3-16 href=#__codelineno-3-16></a>        <span class=c1># Format results</span>
<a id=__codelineno-3-17 name=__codelineno-3-17 href=#__codelineno-3-17></a>        <span class=n>final_result</span> <span class=o>=</span> <span class=n>format_document_result</span><span class=p>(</span><span class=n>parsed_result</span><span class=p>)</span>
<a id=__codelineno-3-18 name=__codelineno-3-18 href=#__codelineno-3-18></a>
<a id=__codelineno-3-19 name=__codelineno-3-19 href=#__codelineno-3-19></a>        <span class=c1># Update task status and results</span>
<a id=__codelineno-3-20 name=__codelineno-3-20 href=#__codelineno-3-20></a>        <span class=n>update_task_status</span><span class=p>(</span><span class=n>task</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>],</span> <span class=s1>&#39;completed&#39;</span><span class=p>,</span> <span class=n>final_result</span><span class=p>)</span>
<a id=__codelineno-3-21 name=__codelineno-3-21 href=#__codelineno-3-21></a>
<a id=__codelineno-3-22 name=__codelineno-3-22 href=#__codelineno-3-22></a>        <span class=c1># Store cache</span>
<a id=__codelineno-3-23 name=__codelineno-3-23 href=#__codelineno-3-23></a>        <span class=n>store_cache</span><span class=p>(</span><span class=n>task</span><span class=p>[</span><span class=s1>&#39;cache_key&#39;</span><span class=p>],</span> <span class=n>final_result</span><span class=p>)</span>
<a id=__codelineno-3-24 name=__codelineno-3-24 href=#__codelineno-3-24></a>
<a id=__codelineno-3-25 name=__codelineno-3-25 href=#__codelineno-3-25></a>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
<a id=__codelineno-3-26 name=__codelineno-3-26 href=#__codelineno-3-26></a>        <span class=n>update_task_status</span><span class=p>(</span><span class=n>task</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>],</span> <span class=s1>&#39;error&#39;</span><span class=p>,</span> <span class=p>{</span><span class=s2>&quot;error&quot;</span><span class=p>:</span> <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)})</span>
<a id=__codelineno-3-27 name=__codelineno-3-27 href=#__codelineno-3-27></a>        <span class=k>raise</span>
</code></pre></div> <h3 id=5-result-processing>5. Result Processing<a class=headerlink href=#5-result-processing title="Permanent link">&para;</a></h3> <p>After LLM processing is complete, the system processes and stores the results:</p> <ol> <li><strong>Result Formatting</strong>:</li> <li>Convert parsed LLM results to standard format</li> <li>Add metadata (such as processing time, source, etc.)</li> <li> <p>Ensure output format consistency</p> </li> <li> <p><strong>Result Storage</strong>:</p> </li> <li>Update task status to "completed"</li> <li>Store processing results</li> <li> <p>Add results to cache</p> </li> <li> <p><strong>Error Handling</strong>:</p> </li> <li>If errors occur during processing, record error information</li> <li>Update task status to "error"</li> <li>Store error details</li> </ol> <p><strong>Code Example</strong>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=k>def</span><span class=w> </span><span class=nf>format_document_result</span><span class=p>(</span><span class=n>parsed_result</span><span class=p>):</span>
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Format document processing results&quot;&quot;&quot;</span>
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a>    <span class=c1># Ensure result contains necessary fields</span>
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>    <span class=n>result</span> <span class=o>=</span> <span class=p>{</span>
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a>        <span class=s2>&quot;title&quot;</span><span class=p>:</span> <span class=n>parsed_result</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;title&quot;</span><span class=p>,</span> <span class=s2>&quot;Unknown Title&quot;</span><span class=p>),</span>
<a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a>        <span class=s2>&quot;document_type&quot;</span><span class=p>:</span> <span class=n>parsed_result</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;document_type&quot;</span><span class=p>,</span> <span class=s2>&quot;Unknown Type&quot;</span><span class=p>),</span>
<a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a>        <span class=s2>&quot;summary&quot;</span><span class=p>:</span> <span class=n>parsed_result</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;summary&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>),</span>
<a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a>        <span class=s2>&quot;key_dates&quot;</span><span class=p>:</span> <span class=n>parsed_result</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;key_dates&quot;</span><span class=p>,</span> <span class=p>[]),</span>
<a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a>        <span class=s2>&quot;key_figures&quot;</span><span class=p>:</span> <span class=n>parsed_result</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;key_figures&quot;</span><span class=p>,</span> <span class=p>[]),</span>
<a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a>        <span class=s2>&quot;key_entities&quot;</span><span class=p>:</span> <span class=n>parsed_result</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;key_entities&quot;</span><span class=p>,</span> <span class=p>[]),</span>
<a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a>        <span class=s2>&quot;metadata&quot;</span><span class=p>:</span> <span class=p>{</span>
<a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a>            <span class=s2>&quot;processed_at&quot;</span><span class=p>:</span> <span class=nb>int</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()),</span>
<a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a>            <span class=s2>&quot;source&quot;</span><span class=p>:</span> <span class=s2>&quot;document_processing&quot;</span>
<a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a>        <span class=p>}</span>
<a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a>    <span class=p>}</span>
<a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a>
<a id=__codelineno-4-17 name=__codelineno-4-17 href=#__codelineno-4-17></a>    <span class=k>return</span> <span class=n>result</span>
</code></pre></div> <h3 id=6-status-query-and-result-return>6. Status Query and Result Return<a class=headerlink href=#6-status-query-and-result-return title="Permanent link">&para;</a></h3> <p>Clients can use the task ID to query processing status and results:</p> <ol> <li><strong>Status Query</strong>:</li> <li>Client queries task status through the <code>/api/task_status</code> endpoint</li> <li>Provides task ID as parameter</li> <li> <p>System returns current task status (pending, processing, completed, error)</p> </li> <li> <p><strong>Result Query</strong>:</p> </li> <li>If task is completed, system returns processing results</li> <li>If task is not completed, system returns current status</li> <li> <p>If task has error, system returns error information</p> </li> <li> <p><strong>Response Encryption</strong>:</p> </li> <li>Encrypt response data using previous AES key</li> <li>Calculate signature for response data</li> <li>Return encrypted response and signature</li> </ol> <p><strong>Code Example</strong>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=nd>@app</span><span class=o>.</span><span class=n>route</span><span class=p>(</span><span class=s1>&#39;/api/task_status&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;POST&#39;</span><span class=p>])</span>
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=k>def</span><span class=w> </span><span class=nf>get_task_status</span><span class=p>():</span>
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>    <span class=k>try</span><span class=p>:</span>
<a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>        <span class=c1># Decrypt request</span>
<a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>request</span><span class=o>.</span><span class=n>is_json</span><span class=p>:</span>
<a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a>            <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s2>&quot;error&quot;</span><span class=p>:</span> <span class=s2>&quot;Request must be in JSON format&quot;</span><span class=p>}),</span> <span class=mi>400</span>
<a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a>
<a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a>        <span class=n>data</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>get_json</span><span class=p>()</span>
<a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a>
<a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a>        <span class=c1># Validate required parameters</span>
<a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a>        <span class=n>required_fields</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;encrypted_data&#39;</span><span class=p>,</span> <span class=s1>&#39;encrypted_key&#39;</span><span class=p>,</span> <span class=s1>&#39;signature&#39;</span><span class=p>]</span>
<a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a>        <span class=k>for</span> <span class=n>field</span> <span class=ow>in</span> <span class=n>required_fields</span><span class=p>:</span>
<a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a>            <span class=k>if</span> <span class=n>field</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>data</span><span class=p>:</span>
<a id=__codelineno-5-14 name=__codelineno-5-14 href=#__codelineno-5-14></a>                <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s2>&quot;error&quot;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&quot;Missing required parameter: </span><span class=si>{</span><span class=n>field</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>}),</span> <span class=mi>400</span>
<a id=__codelineno-5-15 name=__codelineno-5-15 href=#__codelineno-5-15></a>
<a id=__codelineno-5-16 name=__codelineno-5-16 href=#__codelineno-5-16></a>        <span class=c1># Decrypt request data</span>
<a id=__codelineno-5-17 name=__codelineno-5-17 href=#__codelineno-5-17></a>        <span class=k>try</span><span class=p>:</span>
<a id=__codelineno-5-18 name=__codelineno-5-18 href=#__codelineno-5-18></a>            <span class=n>decrypted_data</span><span class=p>,</span> <span class=n>aes_key</span> <span class=o>=</span> <span class=n>decrypt_request</span><span class=p>(</span>
<a id=__codelineno-5-19 name=__codelineno-5-19 href=#__codelineno-5-19></a>                <span class=n>data</span><span class=p>[</span><span class=s1>&#39;encrypted_data&#39;</span><span class=p>],</span>
<a id=__codelineno-5-20 name=__codelineno-5-20 href=#__codelineno-5-20></a>                <span class=n>data</span><span class=p>[</span><span class=s1>&#39;encrypted_key&#39;</span><span class=p>],</span>
<a id=__codelineno-5-21 name=__codelineno-5-21 href=#__codelineno-5-21></a>                <span class=n>data</span><span class=p>[</span><span class=s1>&#39;signature&#39;</span><span class=p>]</span>
<a id=__codelineno-5-22 name=__codelineno-5-22 href=#__codelineno-5-22></a>            <span class=p>)</span>
<a id=__codelineno-5-23 name=__codelineno-5-23 href=#__codelineno-5-23></a>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
<a id=__codelineno-5-24 name=__codelineno-5-24 href=#__codelineno-5-24></a>            <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s2>&quot;error&quot;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&quot;Request decryption failed: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>}),</span> <span class=mi>400</span>
<a id=__codelineno-5-25 name=__codelineno-5-25 href=#__codelineno-5-25></a>
<a id=__codelineno-5-26 name=__codelineno-5-26 href=#__codelineno-5-26></a>        <span class=c1># Validate task ID</span>
<a id=__codelineno-5-27 name=__codelineno-5-27 href=#__codelineno-5-27></a>        <span class=k>if</span> <span class=s1>&#39;task_id&#39;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>decrypted_data</span><span class=p>:</span>
<a id=__codelineno-5-28 name=__codelineno-5-28 href=#__codelineno-5-28></a>            <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s2>&quot;error&quot;</span><span class=p>:</span> <span class=s2>&quot;Missing task_id parameter&quot;</span><span class=p>}),</span> <span class=mi>400</span>
<a id=__codelineno-5-29 name=__codelineno-5-29 href=#__codelineno-5-29></a>
<a id=__codelineno-5-30 name=__codelineno-5-30 href=#__codelineno-5-30></a>        <span class=n>task_id</span> <span class=o>=</span> <span class=n>decrypted_data</span><span class=p>[</span><span class=s1>&#39;task_id&#39;</span><span class=p>]</span>
<a id=__codelineno-5-31 name=__codelineno-5-31 href=#__codelineno-5-31></a>
<a id=__codelineno-5-32 name=__codelineno-5-32 href=#__codelineno-5-32></a>        <span class=c1># Query task status</span>
<a id=__codelineno-5-33 name=__codelineno-5-33 href=#__codelineno-5-33></a>        <span class=n>task_result</span> <span class=o>=</span> <span class=n>get_task_result</span><span class=p>(</span><span class=n>task_id</span><span class=p>)</span>
<a id=__codelineno-5-34 name=__codelineno-5-34 href=#__codelineno-5-34></a>
<a id=__codelineno-5-35 name=__codelineno-5-35 href=#__codelineno-5-35></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>task_result</span><span class=p>:</span>
<a id=__codelineno-5-36 name=__codelineno-5-36 href=#__codelineno-5-36></a>            <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s2>&quot;error&quot;</span><span class=p>:</span> <span class=s2>&quot;Task does not exist&quot;</span><span class=p>}),</span> <span class=mi>404</span>
<a id=__codelineno-5-37 name=__codelineno-5-37 href=#__codelineno-5-37></a>
<a id=__codelineno-5-38 name=__codelineno-5-38 href=#__codelineno-5-38></a>        <span class=c1># Encrypt response</span>
<a id=__codelineno-5-39 name=__codelineno-5-39 href=#__codelineno-5-39></a>        <span class=n>response</span> <span class=o>=</span> <span class=n>encrypt_response</span><span class=p>(</span><span class=n>task_result</span><span class=p>,</span> <span class=n>aes_key</span><span class=p>)</span>
<a id=__codelineno-5-40 name=__codelineno-5-40 href=#__codelineno-5-40></a>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>(</span><span class=n>response</span><span class=p>),</span> <span class=mi>200</span>
<a id=__codelineno-5-41 name=__codelineno-5-41 href=#__codelineno-5-41></a>
<a id=__codelineno-5-42 name=__codelineno-5-42 href=#__codelineno-5-42></a>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
<a id=__codelineno-5-43 name=__codelineno-5-43 href=#__codelineno-5-43></a>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s2>&quot;error&quot;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&quot;Failed to process request: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>}),</span> <span class=mi>500</span>
</code></pre></div> <h2 id=document-processing-prompt>Document Processing Prompt<a class=headerlink href=#document-processing-prompt title="Permanent link">&para;</a></h2> <p>The document processing workflow uses a specially designed prompt template to guide LLM in analyzing document content:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a>You are a professional document analysis assistant. Please analyze the following document content, extract key information, and output in the specified format.
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>Document content:
<a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a>{document_text}
<a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a>
<a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a>Please provide the following information:
<a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a>1. Document title
<a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a>2. Document type (e.g., report, contract, notice, etc.)
<a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a>3. Main content summary
<a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a>4. Key dates and figures
<a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a>5. Important names and organizations
<a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a>
<a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a>Please output the result in JSON format, including the following fields:
<a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a>- title: Document title
<a id=__codelineno-6-15 name=__codelineno-6-15 href=#__codelineno-6-15></a>- document_type: Document type
<a id=__codelineno-6-16 name=__codelineno-6-16 href=#__codelineno-6-16></a>- summary: Content summary (100-200 words)
<a id=__codelineno-6-17 name=__codelineno-6-17 href=#__codelineno-6-17></a>- key_dates: List of key dates, each item includes date (date) and context (context)
<a id=__codelineno-6-18 name=__codelineno-6-18 href=#__codelineno-6-18></a>- key_figures: List of key figures, each item includes figure (figure) and context (context)
<a id=__codelineno-6-19 name=__codelineno-6-19 href=#__codelineno-6-19></a>- key_entities: List of important names and organizations, each item includes name (name) and role (role)
</code></pre></div> <p>This prompt template guides LLM to extract key information from documents and output results in structured JSON format.</p> <h2 id=processing-result-example>Processing Result Example<a class=headerlink href=#processing-result-example title="Permanent link">&para;</a></h2> <p>The output of the document processing workflow is structured JSON data containing key information about the document:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=p>{</span>
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=w>  </span><span class=nt>&quot;title&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Report on 2023 Budget Execution&quot;</span><span class=p>,</span>
<a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=w>  </span><span class=nt>&quot;document_type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Financial Report&quot;</span><span class=p>,</span>
<a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=w>  </span><span class=nt>&quot;summary&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;This report provides a detailed analysis of the 2023 budget execution, including income and expenditure overview, major project execution progress, and existing issues. Overall execution is good, with income achievement rate of 98%, expenditure controlled within budget, and major projects progressing as planned.&quot;</span><span class=p>,</span>
<a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=w>  </span><span class=nt>&quot;key_dates&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
<a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a><span class=w>    </span><span class=p>{</span>
<a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a><span class=w>      </span><span class=nt>&quot;date&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;2023-01-15&quot;</span><span class=p>,</span>
<a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a><span class=w>      </span><span class=nt>&quot;context&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Budget plan officially approved&quot;</span>
<a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a><span class=w>    </span><span class=p>},</span>
<a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a><span class=w>    </span><span class=p>{</span>
<a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a><span class=w>      </span><span class=nt>&quot;date&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;2023-06-30&quot;</span><span class=p>,</span>
<a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a><span class=w>      </span><span class=nt>&quot;context&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;First half budget execution review&quot;</span>
<a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a><span class=w>    </span><span class=p>},</span>
<a id=__codelineno-7-14 name=__codelineno-7-14 href=#__codelineno-7-14></a><span class=w>    </span><span class=p>{</span>
<a id=__codelineno-7-15 name=__codelineno-7-15 href=#__codelineno-7-15></a><span class=w>      </span><span class=nt>&quot;date&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;2023-12-31&quot;</span><span class=p>,</span>
<a id=__codelineno-7-16 name=__codelineno-7-16 href=#__codelineno-7-16></a><span class=w>      </span><span class=nt>&quot;context&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Annual budget execution deadline&quot;</span>
<a id=__codelineno-7-17 name=__codelineno-7-17 href=#__codelineno-7-17></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-7-18 name=__codelineno-7-18 href=#__codelineno-7-18></a><span class=w>  </span><span class=p>],</span>
<a id=__codelineno-7-19 name=__codelineno-7-19 href=#__codelineno-7-19></a><span class=w>  </span><span class=nt>&quot;key_figures&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
<a id=__codelineno-7-20 name=__codelineno-7-20 href=#__codelineno-7-20></a><span class=w>    </span><span class=p>{</span>
<a id=__codelineno-7-21 name=__codelineno-7-21 href=#__codelineno-7-21></a><span class=w>      </span><span class=nt>&quot;figure&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;1,500,000&quot;</span><span class=p>,</span>
<a id=__codelineno-7-22 name=__codelineno-7-22 href=#__codelineno-7-22></a><span class=w>      </span><span class=nt>&quot;context&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Annual total budget (yuan)&quot;</span>
<a id=__codelineno-7-23 name=__codelineno-7-23 href=#__codelineno-7-23></a><span class=w>    </span><span class=p>},</span>
<a id=__codelineno-7-24 name=__codelineno-7-24 href=#__codelineno-7-24></a><span class=w>    </span><span class=p>{</span>
<a id=__codelineno-7-25 name=__codelineno-7-25 href=#__codelineno-7-25></a><span class=w>      </span><span class=nt>&quot;figure&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;1,470,000&quot;</span><span class=p>,</span>
<a id=__codelineno-7-26 name=__codelineno-7-26 href=#__codelineno-7-26></a><span class=w>      </span><span class=nt>&quot;context&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Actual total income (yuan)&quot;</span>
<a id=__codelineno-7-27 name=__codelineno-7-27 href=#__codelineno-7-27></a><span class=w>    </span><span class=p>},</span>
<a id=__codelineno-7-28 name=__codelineno-7-28 href=#__codelineno-7-28></a><span class=w>    </span><span class=p>{</span>
<a id=__codelineno-7-29 name=__codelineno-7-29 href=#__codelineno-7-29></a><span class=w>      </span><span class=nt>&quot;figure&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;1,420,000&quot;</span><span class=p>,</span>
<a id=__codelineno-7-30 name=__codelineno-7-30 href=#__codelineno-7-30></a><span class=w>      </span><span class=nt>&quot;context&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Actual total expenditure (yuan)&quot;</span>
<a id=__codelineno-7-31 name=__codelineno-7-31 href=#__codelineno-7-31></a><span class=w>    </span><span class=p>},</span>
<a id=__codelineno-7-32 name=__codelineno-7-32 href=#__codelineno-7-32></a><span class=w>    </span><span class=p>{</span>
<a id=__codelineno-7-33 name=__codelineno-7-33 href=#__codelineno-7-33></a><span class=w>      </span><span class=nt>&quot;figure&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;98%&quot;</span><span class=p>,</span>
<a id=__codelineno-7-34 name=__codelineno-7-34 href=#__codelineno-7-34></a><span class=w>      </span><span class=nt>&quot;context&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Income achievement rate&quot;</span>
<a id=__codelineno-7-35 name=__codelineno-7-35 href=#__codelineno-7-35></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-7-36 name=__codelineno-7-36 href=#__codelineno-7-36></a><span class=w>  </span><span class=p>],</span>
<a id=__codelineno-7-37 name=__codelineno-7-37 href=#__codelineno-7-37></a><span class=w>  </span><span class=nt>&quot;key_entities&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
<a id=__codelineno-7-38 name=__codelineno-7-38 href=#__codelineno-7-38></a><span class=w>    </span><span class=p>{</span>
<a id=__codelineno-7-39 name=__codelineno-7-39 href=#__codelineno-7-39></a><span class=w>      </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Zhang Ming&quot;</span><span class=p>,</span>
<a id=__codelineno-7-40 name=__codelineno-7-40 href=#__codelineno-7-40></a><span class=w>      </span><span class=nt>&quot;role&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Financial Director&quot;</span>
<a id=__codelineno-7-41 name=__codelineno-7-41 href=#__codelineno-7-41></a><span class=w>    </span><span class=p>},</span>
<a id=__codelineno-7-42 name=__codelineno-7-42 href=#__codelineno-7-42></a><span class=w>    </span><span class=p>{</span>
<a id=__codelineno-7-43 name=__codelineno-7-43 href=#__codelineno-7-43></a><span class=w>      </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Finance Committee&quot;</span><span class=p>,</span>
<a id=__codelineno-7-44 name=__codelineno-7-44 href=#__codelineno-7-44></a><span class=w>      </span><span class=nt>&quot;role&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Budget approval organization&quot;</span>
<a id=__codelineno-7-45 name=__codelineno-7-45 href=#__codelineno-7-45></a><span class=w>    </span><span class=p>},</span>
<a id=__codelineno-7-46 name=__codelineno-7-46 href=#__codelineno-7-46></a><span class=w>    </span><span class=p>{</span>
<a id=__codelineno-7-47 name=__codelineno-7-47 href=#__codelineno-7-47></a><span class=w>      </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Li Hua&quot;</span><span class=p>,</span>
<a id=__codelineno-7-48 name=__codelineno-7-48 href=#__codelineno-7-48></a><span class=w>      </span><span class=nt>&quot;role&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Budget execution manager&quot;</span>
<a id=__codelineno-7-49 name=__codelineno-7-49 href=#__codelineno-7-49></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-7-50 name=__codelineno-7-50 href=#__codelineno-7-50></a><span class=w>  </span><span class=p>],</span>
<a id=__codelineno-7-51 name=__codelineno-7-51 href=#__codelineno-7-51></a><span class=w>  </span><span class=nt>&quot;metadata&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-7-52 name=__codelineno-7-52 href=#__codelineno-7-52></a><span class=w>    </span><span class=nt>&quot;processed_at&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>1679012345</span><span class=p>,</span>
<a id=__codelineno-7-53 name=__codelineno-7-53 href=#__codelineno-7-53></a><span class=w>    </span><span class=nt>&quot;source&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;document_processing&quot;</span>
<a id=__codelineno-7-54 name=__codelineno-7-54 href=#__codelineno-7-54></a><span class=w>  </span><span class=p>}</span>
<a id=__codelineno-7-55 name=__codelineno-7-55 href=#__codelineno-7-55></a><span class=p>}</span>
</code></pre></div> <h2 id=error-handling>Error Handling<a class=headerlink href=#error-handling title="Permanent link">&para;</a></h2> <p>The document processing workflow implements comprehensive error handling mechanisms:</p> <ol> <li><strong>Request Errors</strong>:</li> <li>Missing parameters or incorrect format</li> <li>Decryption failure or signature verification failure</li> <li> <p>Image count exceeds limit</p> </li> <li> <p><strong>OCR Errors</strong>:</p> </li> <li>Image decoding failure</li> <li>OCR service call failure</li> <li> <p>OCR result format error</p> </li> <li> <p><strong>LLM Errors</strong>:</p> </li> <li>LLM API call failure</li> <li>Response parsing failure</li> <li> <p>Result format does not meet expectations</p> </li> <li> <p><strong>System Errors</strong>:</p> </li> <li>Database operation failure</li> <li>Insufficient resources</li> <li>Service unavailable</li> </ol> <p>Each type of error has a corresponding handling strategy, ensuring the system can gracefully handle exceptions and provide clear error feedback.</p> <h2 id=performance-optimization>Performance Optimization<a class=headerlink href=#performance-optimization title="Permanent link">&para;</a></h2> <p>The document processing workflow implements various performance optimization measures:</p> <ol> <li><strong>Parallel Processing</strong>:</li> <li>Use thread pools to process multiple images in parallel</li> <li> <p>Improve processing efficiency, reduce total processing time</p> </li> <li> <p><strong>Caching Mechanism</strong>:</p> </li> <li>Cache processing results to avoid duplicate computation</li> <li> <p>Improve response speed for identical requests</p> </li> <li> <p><strong>Asynchronous Processing</strong>:</p> </li> <li>Use task queues and worker threads for asynchronous processing</li> <li> <p>Improve system responsiveness and concurrent processing capability</p> </li> <li> <p><strong>Resource Control</strong>:</p> </li> <li>Use semaphores to control concurrency</li> <li>Avoid excessive resource consumption and service overload</li> </ol> <p>Through these designs and implementations, the document processing workflow can efficiently and reliably convert document images into structured text data, providing valuable document analysis services to users.</p> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2025 JI-DeepSleep </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["content.code.annotate", "content.tabs.link", "header.autohide", "navigation.expand", "navigation.indexes", "navigation.instant", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.50899def.min.js></script> </body> </html>